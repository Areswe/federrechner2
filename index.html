<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Schraubendruckfeder – Auslegung</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      color: #222;
    }
    header {
      background: #1f4e79;
      color: white;
      padding: 1rem 2rem;
    }
    header h1 {
      margin: 0;
      font-size: 1.4rem;
    }
    main {
      padding: 1.5rem 2rem;
      display: grid;
      grid-template-columns: minmax(0, 430px) minmax(0, 1fr);
      gap: 1.5rem;
    }
    fieldset {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 1rem 1.2rem;
      margin-bottom: 1rem;
      background: white;
    }
    legend {
      padding: 0 0.4rem;
      font-weight: 600;
    }
    label {
      display: block;
      font-size: 0.9rem;
      margin-bottom: 0.15rem;
    }
    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.6rem 1rem;
      margin-bottom: 0.4rem;
    }
    input, select {
      width: 100%;
      box-sizing: border-box;
      padding: 0.3rem 0.4rem;
      border-radius: 4px;
      border: 1px solid #bbb;
      font-size: 0.9rem;
    }
    .unit {
      font-size: 0.8rem;
      color: #555;
      margin-left: 0.25rem;
    }
    button {
      padding: 0.4rem 0.9rem;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      font-size: 0.95rem;
      margin-right: 0.4rem;
    }
    button.primary {
      background: #1f4e79;
      color: white;
    }
    button.secondary {
      background: #ddd;
      color: #222;
    }
    #output {
      background: white;
      border-radius: 8px;
      padding: 1rem 1.2rem;
      border: 1px solid #ccc;
      margin-bottom: 1rem;
      font-size: 0.9rem;
    }
    #output h2 {
      margin-top: 0;
      font-size: 1rem;
      border-bottom: 1px solid #eee;
      padding-bottom: 0.3rem;
    }
    #output table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.4rem;
    }
    #output th, #output td {
      text-align: left;
      padding: 0.2rem 0.3rem;
      border-bottom: 1px solid #eee;
      font-size: 0.9rem;
    }
    #chartContainer {
      background: white;
      border-radius: 8px;
      padding: 1rem 1.2rem;
      border: 1px solid #ccc;
    }
    #chartContainer h2 {
      margin-top: 0;
      font-size: 1rem;
      border-bottom: 1px solid #eee;
      padding-bottom: 0.3rem;
    }
    canvas {
      border: 1px solid #ddd;
      border-radius: 4px;
      background: #fff;
    }
    .hint {
      font-size: 0.8rem;
      color: #666;
      margin-top: 0.4rem;
    }
    .formula-list {
      margin-top: 0.9rem;
      padding-top: 0.6rem;
      border-top: 1px solid #eee;
      font-size: 0.85rem;
    }
    .formula-list h3 {
      margin: 0 0 0.4rem 0;
      font-size: 0.95rem;
    }
    .formula-list ul {
      margin: 0;
      padding-left: 1.1rem;
    }
    .formula-list li {
      margin-bottom: 0.25rem;
    }
    .formula-name {
      font-weight: 600;
    }
    .formula-page {
      color: #555;
      font-size: 0.8rem;
      margin-left: 0.3rem;
    }
    code {
      font-family: "Consolas", "Fira Code", monospace;
      font-size: 0.8rem;
      background: #f3f3f3;
      padding: 0.05rem 0.25rem;
      border-radius: 3px;
    }
    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
<header>
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h1>Schraubendruckfeder – Auslegungstool (BISM WS2025/26)</h1>

    <!-- HSRM Logo rechts oben -->
    <img src="C:\Users\9816\OneDrive - ESWE Verkehrsgesellschaft mbH\Bilder\logohsrm_white.png"
         alt="Hochschule RheinMain"
         style="height:60px; margin-left:20px;">
  </div>
</header>
<main>
  <!-- Eingaben -->
  <section>
    <fieldset>
      <legend>Geometrie der Feder</legend>
      <div class="row">
        <div>
          <label>Drahtdurchmesser d <span class="unit">[mm]</span></label>
          <input type="number" id="d" value="2" min="0" step="0.01">
        </div>
        <div>
          <label>Mittlerer Durchmesser D <span class="unit">[mm]</span></label>
          <input type="number" id="D" value="15" min="0" step="0.01">
        </div>
        <div>
          <label>Anzahl federnde Windungen n</label>
          <input type="number" id="n" value="6" min="1" step="0.1">
        </div>
        <div>
          <label>Gesamtwindungen n<sub>t</sub> (optional)</label>
          <input type="number" id="nt" placeholder="leer = n + 2">
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Werkstoff / Material</legend>
      <div class="row">
        <div>
          <label>Werkstoffwahl</label>
          <select id="material">
            <option value="patentiert">Patentiert gezogener Federdraht (EN 10270-1)</option>
            <option value="oelschluss" selected>Ölschlussvergüteter Federdraht (EN 10270-2)</option>
            <option value="custom">G frei eingeben</option>
          </select>
        </div>
        <div>
          <label>Schubmodul G <span class="unit">[N/mm²]</span></label>
          <input type="number" id="G" value="79500" step="100">
        </div>
      </div>
      <div class="hint">
        Richtwerte: G ≈ 81 500 N/mm² (patentiert), 79 500 N/mm² (ölschlussvergütet).
      </div>
    </fieldset>

    <fieldset>
      <legend>Arbeitsdaten</legend>
      <div class="row">
        <div>
          <label>Federweg s₁ <span class="unit">[mm]</span></label>
          <input type="number" id="s1" value="5" step="0.1">
        </div>
        <div>
          <label>Federweg s₂ <span class="unit">[mm]</span></label>
          <input type="number" id="s2" value="15" step="0.1">
        </div>
        <div>
          <label>Blockabstand s<sub>c</sub> (Restabstand) <span class="unit">[mm]</span></label>
          <input type="number" id="sc" value="1" step="0.1">
        </div>
        <div>
          <label>Ungespannte Länge L₀ (optional) <span class="unit">[mm]</span></label>
          <input type="number" id="L0" placeholder="optional">
        </div>
      </div>
      <div class="hint">
        Blocklänge L<sub>c</sub> ≈ n<sub>t</sub> · d (kaltgeformt, d ≤ 10&nbsp;mm).
      </div>
    </fieldset>

    <fieldset>
      <legend>Zusatz: Festigkeit & Knicksicherheit</legend>
      <div class="row">
        <div>
          <label>Zugfestigkeit R<sub>m</sub> <span class="unit">[N/mm²]</span></label>
          <input type="number" id="Rm" placeholder="für Blockspannungsnachweis">
        </div>
        <div>
          <label>Dauerhubfestigkeit τ<sub>H</sub> <span class="unit">[N/mm²]</span></label>
          <input type="number" id="tauH" placeholder="aus Goodman-Diagramm">
        </div>
        <div>
          <label>Lagerungsbeiwert ν<sub>k</sub> <span class="unit">[-]</span></label>
          <input type="number" id="nuK" placeholder="z.B. 0,5 / 1,0" step="0.01">
        </div>
        <div>
          <label>Federlänge im Betrieb L<sub>f</sub> <span class="unit">[mm]</span></label>
          <input type="number" id="Lf" placeholder="für Knicksicherheitsnachweis">
        </div>
      </div>
      <div class="hint">
        R<sub>m</sub> und τ<sub>H</sub> aus Tabellen/Diagrammen der Formelsammlung entnehmen. L<sub>f</sub> und ν<sub>k</sub> für Knicksicherheit.
      </div>
    </fieldset>

    <div style="margin-top:0.5rem;">
      <button class="primary" onclick="berechnen()">Berechnen</button>
      <button class="secondary" onclick="resetForm()">Zurücksetzen</button>
    </div>
  </section>

  <!-- Ausgaben + Diagramm -->
  <section>
    <div id="output">
      <h2>Ergebnisse</h2>
      <div id="resultsText">Bitte auf „Berechnen“ klicken.</div>
    </div>
    <div id="chartContainer">
      <h2>Federkennlinie F–s</h2>
      <canvas id="chart" width="600" height="300"></canvas>
      <div class="hint">
        Es wird eine lineare Kennlinie mit der berechneten Federrate R im Bereich 0 … max(s₁, s₂, Blockweg) dargestellt.
      </div>
    </div>
  </section>
</main>

<script>
  // Material-Auswahl setzt G automatisch
  document.getElementById('material').addEventListener('change', function () {
    const mat = this.value;
    const Ginput = document.getElementById('G');
    if (mat === 'patentiert') {
      Ginput.value = 81500;
      Ginput.readOnly = true;
    } else if (mat === 'oelschluss') {
      Ginput.value = 79500;
      Ginput.readOnly = true;
    } else {
      Ginput.readOnly = false;
    }
  });

  function berechnen() {
    const d  = parseFloat(document.getElementById('d').value);
    const D  = parseFloat(document.getElementById('D').value);
    const n  = parseFloat(document.getElementById('n').value);
    const ntInput = document.getElementById('nt').value;
    const nt = ntInput ? parseFloat(ntInput) : (n + 2); // Standardformel nt = n + 2
    const G  = parseFloat(document.getElementById('G').value);
    const s1 = parseFloat(document.getElementById('s1').value);
    const s2 = parseFloat(document.getElementById('s2').value);
    const sc = parseFloat(document.getElementById('sc').value);
    const L0Input = document.getElementById('L0').value;
    const L0 = L0Input ? parseFloat(L0Input) : null;

    const Rm = parseFloat(document.getElementById('Rm').value);
    const tauH = parseFloat(document.getElementById('tauH').value);
    const nuK = parseFloat(document.getElementById('nuK').value);
    const LfInput = document.getElementById('Lf').value;
    const Lf = LfInput ? parseFloat(LfInput) : null;

    if (isNaN(d) || isNaN(D) || isNaN(n) || isNaN(G)) {
      document.getElementById('resultsText').innerText =
        "Bitte mindestens d, D, n und G korrekt eingeben.";
      return;
    }

    // Wickelverhältnis
    const W = D / d;

    // Federrate R = (G * d^4) / (8 * D^3 * n)  (Formelsammlung S. 4)
    const R = (G * Math.pow(d, 4)) / (8 * Math.pow(D, 3) * n); // N/mm

    // Kräfte bei s1, s2  (F = R·s, S. 2/4)
    const F1 = !isNaN(s1) ? R * s1 : null;
    const F2 = !isNaN(s2) ? R * s2 : null;

    // Blocklänge Lc ≈ nt * d (kaltgeformt, S. 4)
    const Lc = nt * d;

    // Federlängen bei Wegen (falls L0 gegeben) (L = L0 - s, S. 4)
    let L1 = null, L2 = null;
    if (L0 !== null && !isNaN(L0)) {
      if (!isNaN(s1)) L1 = L0 - s1;
      if (!isNaN(s2)) L2 = L0 - s2;
    }

    // Blockweg: s_block = L0 - Lc - sc (aus L = L0 - s, Blocklage)
    let s_block = null;
    if (L0 !== null && !isNaN(L0) && !isNaN(sc)) {
      s_block = L0 - Lc - sc;
    }

    // Wahl-Faktor k (Näherung, Formelsammlung S. 3)
    let k_wahl = null;
    if (W > 1.1) {
      k_wahl = (4 * W - 1) / (4 * W - 4) + 0.615 / W;
    }

    // Torsionsspannungen bei F1, F2 (S. 3: τ_k = 8 F D / (π d³) · k)
    let tau1 = null, tau2 = null;
    if (k_wahl !== null) {
      if (F1 !== null) {
        tau1 = (8 * F1 * D) / (Math.PI * Math.pow(d, 3)) * k_wahl;
      }
      if (F2 !== null) {
        tau2 = (8 * F2 * D) / (Math.PI * Math.pow(d, 3)) * k_wahl;
      }
    }

    // Blockspannungsnachweis (S. 3, vereinfacht)
    let Fc = null, tau_c = null, tau_c_zul = null, S_stat = null;
    if (s_block !== null && !isNaN(s_block) && s_block > 0) {
      Fc = R * s_block; // Blockkraft
      // einfache Schubspannung am Block, analog Torsion ohne k-Faktor
      tau_c = (8 * Fc * D) / (Math.PI * Math.pow(d, 3));
      if (!isNaN(Rm)) {
        // zulässige Blockspannung für kaltgeformte Federn: τ_c,zul ≈ 0,56·R_m (S. 3)
        tau_c_zul = 0.56 * Rm;
        S_stat = tau_c_zul / tau_c;
      }
    }

    // Dynamischer Nachweis (Goodman-Hilfe, S. 3)
    let tau_m = null, tau_h = null, S_dyn = null;
    if (tau1 !== null && tau2 !== null) {
      tau_m = 0.5 * (tau1 + tau2);      // Mittelspannung
      tau_h = 0.5 * (tau2 - tau1);      // Hubspannung
      if (!isNaN(tauH) && tau_h > 0) {
        // Sicherheit ≈ τ_H / τ_h; in der Formelsammlung wird meist mit ν ≈ 2,1 gearbeitet
        S_dyn = tauH / tau_h;
      }
    }

    // Knicksicherheit – Hilfsgrößen (S. 5: L_k = ν · L_f)
    let Lk = null, lambda = null;
    if (!isNaN(nuK) && (Lf !== null && !isNaN(Lf))) {
      Lk = nuK * Lf;
      lambda = Lk / D;  // Verhältniszahλ = Lk / D (zur Einordnung im Diagramm)
    }

    // Ausgabe aufbauen
    const out = [];
    out.push("<table>");
    out.push("<tr><th>Größe</th><th>Symbol</th><th>Wert</th><th>Einheit</th></tr>");
    out.push(row("Drahtdurchmesser", "d", d.toFixed(3), "mm"));
    out.push(row("Mittlerer Durchmesser", "D", D.toFixed(3), "mm"));
    out.push(row("Wickelverhältnis", "W = D/d", W.toFixed(3), "-"));
    out.push(row("Federnde Windungen", "n", n.toFixed(2), "-"));
    out.push(row("Gesamtzahl Windungen", "n<sub>t</sub>", nt.toFixed(2), "-"));
    out.push(row("Schubmodul", "G", G.toFixed(0), "N/mm²"));
    out.push(row("Federrate", "R", R.toFixed(3), "N/mm"));
    if (F1 !== null) {
      out.push(row("Kraft bei s₁", "F₁ = R·s₁", F1.toFixed(2), "N"));
    }
    if (F2 !== null) {
      out.push(row("Kraft bei s₂", "F₂ = R·s₂", F2.toFixed(2), "N"));
    }
    out.push(row("Blocklänge (kaltgeformt)", "L<sub>c</sub> ≈ n<sub>t</sub>·d", Lc.toFixed(2), "mm"));
    if (L0 !== null && !isNaN(L0)) {
      out.push(row("Ungespannte Länge", "L₀", L0.toFixed(2), "mm"));
      if (L1 !== null) out.push(row("Länge bei s₁", "L₁ = L₀ - s₁", L1.toFixed(2), "mm"));
      if (L2 !== null) out.push(row("Länge bei s₂", "L₂ = L₀ - s₂", L2.toFixed(2), "mm"));
      if (s_block !== null && !isNaN(s_block)) {
        out.push(row("Blockweg bei Restabstand s<sub>c</sub>", "s<sub>block</sub>", s_block.toFixed(2), "mm"));
      }
    }
    if (k_wahl !== null) {
      out.push(row("Wahl-Faktor (Spannungskorrektur)", "k", k_wahl.toFixed(3), "-"));
    }
    if (tau1 !== null) {
      out.push(row("Torsionsspannung bei F₁", "τ₁", tau1.toFixed(1), "N/mm²"));
    }
    if (tau2 !== null) {
      out.push(row("Torsionsspannung bei F₂", "τ₂", tau2.toFixed(1), "N/mm²"));
    }

    // Blockspannungsnachweis
    if (Fc !== null) {
      out.push(row("Blockkraft", "F<sub>c</sub>", Fc.toFixed(2), "N"));
    }
    if (tau_c !== null) {
      out.push(row("Blockspannung", "τ<sub>c</sub>", tau_c.toFixed(1), "N/mm²"));
    }
    if (tau_c_zul !== null) {
      out.push(row("zulässige Blockspannung", "τ<sub>c,zul</sub> = 0,56·R<sub>m</sub>",
                   tau_c_zul.toFixed(1), "N/mm²"));
    }
    if (S_stat !== null) {
      out.push(row("Sicherheit Blockspannung", "S<sub>stat</sub> = τ<sub>c,zul</sub>/τ<sub>c</sub>",
                   S_stat.toFixed(2), "-"));
    }

    // Dynamik / Goodman
    if (tau_m !== null && tau_h !== null) {
      out.push(row("Mittelspannung", "τ<sub>m</sub>", tau_m.toFixed(1), "N/mm²"));
      out.push(row("Hubspannung", "τ<sub>h</sub>", tau_h.toFixed(1), "N/mm²"));
    }
    if (S_dyn !== null) {
      out.push(row("Sicherheit dynamisch", "S<sub>dyn</sub> = τ<sub>H</sub>/τ<sub>h</sub>",
                   S_dyn.toFixed(2), "-"));
    }

    // Knicksicherheit
    if (Lk !== null && lambda !== null) {
      out.push(row("Knicklänge", "L<sub>k</sub> = ν<sub>k</sub>·L<sub>f</sub>",
                   Lk.toFixed(2), "mm"));
      out.push(row("Verhältnis Knicklänge / Durchmesser", "λ = L<sub>k</sub> / D",
                   lambda.toFixed(2), "-"));
    }

    out.push("</table>");

    // Kommentar + Formelsammlung-Block
    out.push('<div class="hint" style="margin-top:0.6rem;">');
    out.push("Hinweis: Für die Bewertung bitte mit den Tabellen und Diagrammen ");
    out.push("aus der Formelsammlung (Blockspannung, Goodman-Diagramm, Knicksicherheitsdiagramm) vergleichen.");
    out.push("</div>");

    // Verwendete Formeln mit Seitenangabe
    out.push('<div class="formula-list">');
    out.push('<h3>Verwendete Formeln (Formelsammlung Konstruktion 3)</h3>');
    out.push('<ul>');
    out.push('<li><span class="formula-name">Federrate konkret</span>' +
             '<span class="formula-page">(Seite 4)</span>: ' +
             '<code>R = (G · d⁴) / (8 · D³ · n)</code></li>');
    out.push('<li><span class="formula-name">Federkraft aus Weg</span>' +
             '<span class="formula-page">(Seite 2/4)</span>: ' +
             '<code>F = R · s</code></li>');
    out.push('<li><span class="formula-name">Blocklänge, kaltgeformt</span>' +
             '<span class="formula-page">(Seite 4)</span>: ' +
             '<code>L_c = n_t · d</code></li>');
    out.push('<li><span class="formula-name">Federlänge im belasteten Zustand</span>' +
             '<span class="formula-page">(Seite 4)</span>: ' +
             '<code>L = L₀ - s</code></li>');
    out.push('<li><span class="formula-name">Wickelverhältnis</span>' +
             '<span class="formula-page">(Seite 3)</span>: ' +
             '<code>W = D / d</code></li>');
    out.push('<li><span class="formula-name">Wahlfaktor für Spannung</span>' +
             '<span class="formula-page">(Seite 3, Näherung)</span>: ' +
             '<code>k ≈ (4·W - 1) / (4·W - 4) + 0,615 / W</code></li>');
    out.push('<li><span class="formula-name">Torsionsspannung, dynamisch</span>' +
             '<span class="formula-page">(Seite 3)</span>: ' +
             '<code>τ_k = (8 · F · D) / (π · d³) · k</code></li>');
    out.push('<li><span class="formula-name">Blockspannung (vereinfacht)</span>' +
             '<span class="formula-page">(Seite 3)</span>: ' +
             '<code>τ_c ≈ (8 · F_c · D) / (π · d³)</code></li>');
    out.push('<li><span class="formula-name">zulässige Blockspannung</span>' +
             '<span class="formula-page">(Seite 3)</span>: ' +
             '<code>τ_c,zul = 0,56 · R_m</code> (kaltgeformte Federn)</li>');
    out.push('<li><span class="formula-name">Mittel- und Hubspannung</span>' +
             '<span class="formula-page">(Seite 3)</span>: ' +
             '<code>τ_m = (τ₁ + τ₂) / 2</code>, ' +
             '<code>τ_h = (τ₂ - τ₁) / 2</code></li>');
    out.push('<li><span class="formula-name">Sicherheit dynamisch (Goodman-Hilfe)</span>' +
             '<span class="formula-page">(Seite 3)</span>: ' +
             '<code>S_dyn ≈ τ_H / τ_h</code></li>');
    out.push('<li><span class="formula-name">Knicklänge Feder</span>' +
             '<span class="formula-page">(Seite 5)</span>: ' +
             '<code>L_k = ν · L_f</code></li>');
    out.push('</ul>');
    out.push('</div>');

    document.getElementById('resultsText').innerHTML = out.join("");

    // Diagramm aktualisieren
    let sMax = 0;
    if (!isNaN(s1)) sMax = Math.max(sMax, s1);
    if (!isNaN(s2)) sMax = Math.max(sMax, s2);
    if (s_block !== null && !isNaN(s_block)) sMax = Math.max(sMax, s_block);
    if (sMax <= 0) sMax = 10; // Default
    drawChart(R, sMax);
  }

  function row(name, symbol, value, unit) {
    return "<tr><td>" + name + "</td><td>" + symbol +
           "</td><td>" + value + "</td><td>" + unit + "</td></tr>";
  }

  function resetForm() {
    document.getElementById('d').value = 2;
    document.getElementById('D').value = 15;
    document.getElementById('n').value = 6;
    document.getElementById('nt').value = "";
    document.getElementById('material').value = "oelschluss";
    document.getElementById('G').value = 79500;
    document.getElementById('G').readOnly = true;
    document.getElementById('s1').value = 5;
    document.getElementById('s2').value = 15;
    document.getElementById('sc').value = 1;
    document.getElementById('L0').value = "";
    document.getElementById('Rm').value = "";
    document.getElementById('tauH').value = "";
    document.getElementById('nuK').value = "";
    document.getElementById('Lf').value = "";
    document.getElementById('resultsText').innerText =
      "Bitte auf „Berechnen“ klicken.";
    clearChart();
  }

  function clearChart() {
    const canvas = document.getElementById('chart');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  function drawChart(R, sMax) {
    const canvas = document.getElementById('chart');
    const ctx = canvas.getContext('2d');
    const w = canvas.width;
    const h = canvas.height;
    ctx.clearRect(0, 0, w, h);

    // Ränder
    const marginLeft = 50;
    const marginBottom = 35;
    const marginTop = 15;
    const marginRight = 15;

    // Achsenbereich
    const x0 = marginLeft;
    const y0 = h - marginBottom;
    const xMax = w - marginRight;
    const yMax = marginTop;

    // Achsen zeichnen
    ctx.lineWidth = 1;
    ctx.strokeStyle = "#000";
    ctx.beginPath();
    // x-Achse
    ctx.moveTo(x0, y0);
    ctx.lineTo(xMax, y0);
    // y-Achse
    ctx.moveTo(x0, y0);
    ctx.lineTo(x0, yMax);
    ctx.stroke();

    // Skalen
    const sMaxNice = niceNumber(sMax);
    const FMax = R * sMaxNice;
    const FMaxNice = niceNumber(FMax);

    // x-Ticks
    const steps = 5;
    const sx = (xMax - x0) / steps;
    ctx.fillStyle = "#000";
    ctx.font = "10px sans-serif";
    for (let i = 0; i <= steps; i++) {
      const s = (sMaxNice / steps) * i;
      const x = x0 + sx * i;
      ctx.beginPath();
      ctx.moveTo(x, y0);
      ctx.lineTo(x, y0 + 4);
      ctx.stroke();
      ctx.fillText(s.toFixed(1), x - 8, y0 + 14);
    }
    ctx.fillText("s [mm]", (x0 + xMax) / 2 - 10, h - 5);

    // y-Ticks
    const sy = (y0 - yMax) / steps;
    for (let i = 0; i <= steps; i++) {
      const F = (FMaxNice / steps) * i;
      const y = y0 - sy * i;
      ctx.beginPath();
      ctx.moveTo(x0 - 4, y);
      ctx.lineTo(x0, y);
      ctx.stroke();
      ctx.fillText(F.toFixed(1), 5, y + 3);
    }
    ctx.save();
    ctx.translate(12, (y0 + yMax) / 2);
    ctx.rotate(-Math.PI / 2);
    ctx.fillText("F [N]", -15, 0);
    ctx.restore();

    // Kennlinie F = R*s
    ctx.strokeStyle = "#0072c6";
    ctx.lineWidth = 2;
    ctx.beginPath();
    const xStart = x0;
    const yStart = y0;
    const xEnd = xMax;
    const yEnd = y0 - (FMax / FMaxNice) * (y0 - yMax); // skaliert
    ctx.moveTo(xStart, yStart);
    ctx.lineTo(xEnd, yEnd);
    ctx.stroke();
  }

  // Kleine Hilfsfunktion zur „schönen“ Skalierung
  function niceNumber(x) {
    if (!isFinite(x) || x <= 0) return 1;
    const exp = Math.floor(Math.log10(x));
    const f = x / Math.pow(10, exp);
    let nice;
    if (f < 1.5) nice = 1;
    else if (f < 3) nice = 2;
    else if (f < 7) nice = 5;
    else nice = 10;
    return nice * Math.pow(10, exp);
  }

  // Initial
  resetForm();
</script>
</body>
</html>
